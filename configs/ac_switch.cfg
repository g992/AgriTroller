{% set vin_scale = 0.001 %}

[module ac_switch]
name = RS485 AC Switch
type = iarduino
description = Modbus outlet with relay control and level sensors

[actuator relay]
module = ac_switch
register.relay.type = coil
register.relay.addr = 0x0001
register.relay.length = 1
register.relay.on_value = 1
register.relay.off_value = 0
register.relay.mode = binary
register.relay.description = "Main outlet relay"

[actuator indicator]
module = ac_switch
register.led.type = coil
register.led.addr = 0x0000
register.led.length = 1
register.led.on_value = 1
register.led.off_value = 0
register.led.mode = binary
register.led.description = "RJ45 LED"

[sensor level_min]
module = ac_switch
register.level_min.type = di
register.level_min.addr = 0x0000
register.level_min.length = 1
register.level_min.data_type = bool
register.level_min.transform = passthrough
register.level_min.unit = flag
register.level_min.description = "MIN level"

[sensor level_mid]
module = ac_switch
register.level_mid.type = di
register.level_mid.addr = 0x0001
register.level_mid.length = 1
register.level_mid.data_type = bool
register.level_mid.transform = passthrough
register.level_mid.unit = flag
register.level_mid.description = "MID level"

[sensor level_max]
module = ac_switch
register.level_max.type = di
register.level_max.addr = 0x0002
register.level_max.length = 1
register.level_max.data_type = bool
register.level_max.transform = passthrough
register.level_max.unit = flag
register.level_max.description = "MAX level"

[sensor vin]
module = ac_switch
register.vin.type = ai
register.vin.addr = 0x0000
register.vin.length = 2
register.vin.data_type = uint16
register.vin.transform = scale:{{ vin_scale }}
register.vin.unit = V
register.vin.description = "Input voltage"
